I gave up on this about halfway through so it's not actually working.